(this.webpackJsonpcloud_dashboard=this.webpackJsonpcloud_dashboard||[]).push([[0],{31:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),r=n(17),a=n.n(r),i=n(18),s=n(2),l="/clouds/dashboard",d=n(8),u=n.n(d),h=n(10),f=n(1),j=function(){var e=function(){var e=Object(h.a)(u.a.mark((function e(t,n,o){var c,r,a,i,s,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=new FormData).append("grant_type","authorization_code"),c.append("client_id",n),c.append("client_secret","cloud_dashboard"),c.append("code",t),c.append("redirect_uri",o),e.next=8,fetch("/oauth/token",{method:"POST",body:c});case 8:if((r=e.sent).ok){e.next=11;break}throw new Error("Authorization failed");case 11:return e.next=13,r.json();case 13:if(!("access_token"in(a=e.sent))){e.next=23;break}i=a.access_token,s=a.refresh_token,l=(new Date).getTime()+1e3*a.expires_in,window.localStorage.setItem("accessToken",i),window.localStorage.setItem("refreshToken",s),window.localStorage.setItem("expiresDatetime","".concat(l)),e.next=24;break;case 23:throw new Error("Authorization failed");case 24:case"end":return e.stop()}}),e)})));return function(t,n,o){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){console.group("Authorization Code Grant");var t=window.localStorage.getItem("clientId"),n=window.localStorage.getItem("redirectUri");if(null===t||null==n)return console.log("Client ID : No"),console.error("Authorization failed."),console.groupEnd(),void(window.location.href=l);console.log("Client ID : Yes");var o=new URL(window.location.href).searchParams.get("code");if(null===o)return console.log("Authorization code : No"),console.error("Authorization failed."),console.groupEnd(),void(window.location.href=l);console.log("authorization code : Yes"),e(o,t,n).then((function(){console.log("Access token : Yes"),console.groupEnd(),window.location.href=l+"/main"})).catch((function(){console.log("Access token : No"),console.error("Authorization failed."),console.groupEnd(),window.location.href=l}))}),[]),Object(f.jsx)("h2",{children:"Please waiting..."})},b=n(15),w=function(){var e=Object(o.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],r=Object(o.useState)(""),a=Object(b.a)(r,2),i=a[0],s=a[1],l=function(){var e=Object(h.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/jsonapi/consumer/consumer");case 2:return e.next=4,e.sent.json();case 4:t=e.sent,(n=t.data.filter((function(e){return"Cloud Dashboard"===e.attributes.label}))).length>=1&&(c(n[0].id),s(n[0].attributes.redirect));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){l()}),[]),Object(o.useEffect)((function(){window.localStorage.setItem("clientId",n)}),[n]),Object(o.useEffect)((function(){window.localStorage.setItem("redirectUri",i)}),[i]),Object(f.jsx)("form",{children:Object(f.jsx)("button",{type:"button",className:"btn btn-default",onClick:function(){var e="/oauth/authorize?response_type=code&client_id=".concat(n,"&redirect_uri=").concat(i);window.location.href=e},disabled:""===n,children:"login"})})},m=function(){Object(o.useEffect)((function(){var e=window.localStorage.getItem("accessToken"),t=window.localStorage.getItem("expiresDatetime");null!==e&&null!=t?(new Date).getTime()>parseInt(t,10)&&(window.location.href=l):window.location.href=l}),[]);return Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col",children:Object(f.jsx)("form",{children:Object(f.jsx)("button",{type:"button",className:"btn btn-default",onClick:function(){window.localStorage.removeItem("accessToken"),window.localStorage.removeItem("refreshToken"),window.localStorage.removeItem("expiresDatetime"),window.location.href=l},children:"logout"})})})})},p=function(){return Object(f.jsx)(i.a,{basename:l,children:Object(f.jsxs)(s.c,{children:[Object(f.jsx)(s.a,{exact:!0,path:"/callback",children:Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col",children:Object(f.jsx)(j,{})})})})}),Object(f.jsx)(s.a,{exact:!0,path:"/main",children:Object(f.jsx)("div",{className:"container",children:Object(f.jsx)(m,{})})}),Object(f.jsx)(s.a,{exact:!0,path:"/",children:Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col",children:Object(f.jsx)(w,{})})})})})]})})},g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),o(e),c(e),r(e),a(e)}))};a.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(p,{})}),document.getElementById("root")),g()}},[[31,1,2]]]);
//# sourceMappingURL=main.2783c334.chunk.js.map